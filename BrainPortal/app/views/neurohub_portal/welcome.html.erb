<%-
#
# NeuroHub Project
#
# Copyright (C) 2020
# The Royal Institution for the Advancement of Learning
# McGill University
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#
-%>
<%
    new_invites = Invitation.where(user_id: current_user.id, active: true, read: false).all || []
%>

<% title("Dashboard", '') %>

<div id="nh_dashboard">
<div class="title">
<p class="title-md">Welcome <%= @username %></p>
</div>
  <div class="main">
    <div class="notifications">
  

      <% if new_invites.count > 0 %>
        <div id="nh_invitations mb-7 ">
          <div class="section secondary">
            <p class="section-title">New Notifications</p>
              <% new_invites.each do |invitation| %>
                <div class="card">
                  <div class="card-row header">
                    <p class="card-item"><%= invitation.header.html_safe %></p>
                  </div>
                  <div class="btn-section">
                    <%= button_to 'Accept', nh_invitation_path(invitation.id), :method => :put, :class => "btn-solid-secondary btn" %>
                    <%= button_to 'Decline', nh_invitation_path(invitation.id), :method => :delete, :class => "btn-outline-primary btn" %>
                    <%= button_to 'Save for Later', nh_invitation_path(invitation.id, :read => true), :method => :put, :class => "btn-outline-secondary btn" %>
                  </div>
                </div>
              <% end %>
          </div>
        </div>
      <% end %>
      <div class="section transparent flex-1">
        <p class="section-title">Latest Neurohub News</p>
          <div class="card">
            <div class="card-row header bg-default-wash">
              <p class="title-xs">New Portal Underway</p>
            </div>
              <div class="card-item">
                <p class=""> Neurohub news/features </p>
              </div>
        </div>
      </div>
    </div>

    <div class="section user">
      <div class="card">
        <%= link_to "Recently Completed Tasks", {}, :method  => :get, :class=>"btn-text-secondary bg-default-wash" %>
        <div class="card-row">
          <div class="card-item">
            <p class="card-text"> coming soon </p>
          </div>
        </div>
      </div>
      <div class="card">
        <%= link_to "Other User-Related Info", {}, :method  => :get, :class=>"btn-text-secondary bg-default-wash" %>
        <div class="card-row">
          <div class="card-item">
            <p class="card-text"> coming soon </p>
          </div>
        </div>
      </div>
    </div>

  </div>

  <div class="section footer">
    <p class="section-title">For Development:</p>
    <div class="py-4 d-flex justify-center"><%= link_to 'Reboot Manager', reboot_path, { :class => "btn-solid-primary" } %></div>
  </div>
</div>
