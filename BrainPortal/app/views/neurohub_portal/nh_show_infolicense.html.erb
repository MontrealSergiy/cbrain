
<%-
  #
  # NeuroHub Project
  #
  # Copyright (C) 2020
  # The Royal Institution for the Advancement of Learning
  # McGill University
  #
  # This program is free software: you can redistribute it and/or modify
  # it under the terms of the GNU General Public License as published by
  # the Free Software Foundation, either version 3 of the License, or
  # (at your option) any later version.
  #
  # This program is distributed in the hope that it will be useful,
  # but WITHOUT ANY WARRANTY; without even the implied warranty of
  # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  # GNU General Public License for more details.
  #
  # You should have received a copy of the GNU General Public License
  # along with this program.  If not, see <http://www.gnu.org/licenses/>.
  #
-%>

<div id="nh_show_license" class="nh_content">
  <% is_signed = current_user.signed_license_agreements.include?(@license) %>
  <%- # license - %>
  <div class="card">
    <div class="card-section">

    <% if !is_signed %>
      <div class="nh_form">
        <%= form_tag :action => :nh_sign_license, :license => @license %>
        <%= hidden_field_tag :license, @license %>
    <% end %>

      <p class="card-label">Carefully read the following important information:</p>
      <div class="card-text">
        <% content = File.read(Rails.root +
                     "public/licenses/#{@license}.html") rescue "(Error fetching license text)" %>
        <% content.gsub!(/<input\s/i, "<INPUT DISABLED CHECKED ") if is_signed %>
        <%= content.html_safe %>
      </div>

      </div>
      <div class="btn-section">
        <%= submit_tag "I have read this, Continue to NeuroHub", :name => :agree, :class => "btn-solid primary m-1" %>
      </div>
    <% if !is_signed %>
      </form>
    <% end %>
    </div>

  </div>
</div>
